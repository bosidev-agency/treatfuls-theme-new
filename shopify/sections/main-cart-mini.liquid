{%- assign is_empty_cart = false -%}

{%- if cart.item_count == 0 -%}
  {%- assign is_empty_cart = true -%}
{%- endif -%}

<section
	id="minicart-{{- section.id -}}"
	data-section-id="{{- section.id -}}"
	data-section-type="minicart"
>
	<mini-cart
		class="minicart"
		data-section-id="{{- section.id -}}"
		data-section-type="{{- section.type -}}"
	>
		<div class="minicart__overlay {% if isOpened %}minicart__overlay--shown{% endif %}"></div>

		<div class="minicart__container {% if isOpened %}minicart__container--open{% endif %}"
				 style="">
			<div class="minicart__wrapper">
				<div class="minicart__section minicart__section--header">
					<div class="minicart__header">
						<h3 class="minicart__title title-bg title-bg--quaternary title-bg--sm">
							<span><span>{{ 'cart.general.title' | t }}</span></span>
              {%- unless is_empty_cart -%}
                <b>&nbsp{{ cart.item_count }} {{ 'cart.general.mini_cart_item' | t }}</b>
              {%- endunless -%}
						</h3>
						<div class="minicart__close"></div>
					</div>
				</div>

				<div
					class="minicart__body {% if is_empty_cart %}minicart__body--empty{% endif %}"
				>
          {%- if is_empty_cart -%}
            {% render 'empty-mini-cart', emptyButtonText: section.settings.empty_button_text, emptyButtonUrl: section.settings.empty_button_url %}
          {%- else -%}
            <div
              class="minicart__section minicart__section--items js-minicart-items"
            >
              <form id="mini-cart-form" action="{{ routes.cart_url }}" novalidate method="post">
                <input type="hidden" name="checkout">
                {%- for item in cart.items -%}
                  {% render 'cart-item', key: item.key, item: item, is_mini_cart: true %}
                {%- endfor -%}
              </form>
            </div>
          {%- endif -%}
				</div>

				<div class="minicart__section minicart__section--footer">
          {% unless is_empty_cart -%}
            {% render 'cart-subtotal', cart: cart, is_mini_cart: true -%}
          {%- endunless -%}
				</div>
			</div>
		</div>
	</mini-cart>
</section>

{%- schema -%}
{
	"name": "Minicart",
	"settings": [
		{
			"type": "text",
			"id": "empty_button_text",
			"label": "Button text",
			"default": "SHOP ALL",
			"info": "Shown when minimap is empty"
		},
		{
			"type": "url",
			"id": "empty_button_url",
			"label": "Button url"
		}
	]
}
{%- endschema -%}
